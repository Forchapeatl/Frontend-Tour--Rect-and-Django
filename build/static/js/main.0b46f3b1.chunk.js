(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){e.exports=a(78)},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(34),c=a.n(i),s=(a(44),a(35)),l=a(3),o=a(4),u=a(6),m=a(5),p=a(18),d=a(7),h=a(15),f=a(17),v=(a(45),r.a.createContext({booking:null,wishlist:[],toggleWishlist:function(){},addToCart:function(){},removeFromCart:function(){}})),b=(a(46),a(11));a(47),a(48);function E(e){var t=e.itemId;return r.a.createElement(v.Consumer,null,function(e){return r.a.createElement("button",{className:"AddToWishlist",onClick:function(){return e.toggleWishlist(t)}},e.wishlist.includes(t)?r.a.createElement(b.a,null):r.a.createElement(b.d,null))})}function g(e){var t=e.wishlist,a=e.toggleWishlist,n=e.item,i=e.route;return r.a.createElement("div",{className:"Item","data-testid":"item"},r.a.createElement("h3",null,r.a.createElement(E,{wishlist:t,itemId:n.id,toggle:a}),r.a.createElement(h.b,{to:i},n.name)),r.a.createElement("img",{src:n.thumbnail_url,alt:n.name}),r.a.createElement("p",{className:"Item-price"},"$",n.price," USD total"),r.a.createElement("p",null,"Difficulty Rating: ",n.rating,"\xa0",r.a.createElement("span",{className:"Item-rating Item-rating__".concat(n.rating)},r.a.createElement(b.c,null),r.a.createElement(b.c,null),r.a.createElement(b.c,null))),r.a.createElement("p",null,n.promo),r.a.createElement(h.b,{className:"Item-more",to:i},"Learn more!"))}a(54);var y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={price_min:"",price_max:"",search:""},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"updateFilter",value:function(e){var t=this;return function(a){var n={};n[e]=a.target.value,t.setState(n)}}},{key:"applyFilter",value:function(){this.props.onFilterUpdate(this.state)}},{key:"render",value:function(){var e=this.updateFilter("price_min").bind(this),t=this.updateFilter("price_max").bind(this),a=this.updateFilter("search").bind(this),n=this.applyFilter.bind(this),i=this.state,c=i.price_min,s=i.price_max,l=i.search;return r.a.createElement("section",{className:"Filters","data-testid":"filters"},r.a.createElement("label",null,"Price"),r.a.createElement("input",{placeholder:"Minimum",type:"text",size:"7",name:"price_min",value:c,onChange:e}),"\xa0-\xa0",r.a.createElement("input",{placeholder:"Maximum",type:"text",size:"7",name:"price_max",value:s,onChange:t}),r.a.createElement("label",null,"Search"),r.a.createElement("input",{placeholder:"Try typing in 'hiking'",type:"text",size:"20",name:"search",value:l,onChange:a}),r.a.createElement("button",{onClick:n},"Apply"))}}]),t}(r.a.Component);a(55);function k(e){var t=e.pageIndex,a=e.total,n=e.perPage,i=e.onNext,c=e.onPrevious,s=Math.ceil(a/n),l=t>1?r.a.createElement("button",{onClick:c},"Previous"):null,o=t<s?r.a.createElement("button",{onClick:i},"Next"):null;return r.a.createElement("div",{className:"Pagination"},r.a.createElement("div",{className:"Pagination-actions"},l,o),r.a.createElement("div",{className:"Pagination-stats"},"Page ",t," of ",s,"\xa0(displaying ",n," items per page)"))}var O,w=a(1),x=a.n(w),j=a(13),C=a(14),N=a.n(C),_="UYpBkKY6vYW72ayc7ovAZ5xvUapQ3a8TucsGI2jS",P="REvBZR4e1yVflIrF1FAWcLVl08ZtewuxinaQsSNt6XKpxar6v17LvjkrCkKVDqHQUTDCcLfuZfm1V7JQ0C9qdKnYQpbjjjMrYMt76kdzTtE3xGv4ZaxdX9TnLsTeadZu";function I(){return S.apply(this,arguments)}function S(){return(S=Object(j.a)(x.a.mark(function e(){var t,a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){if(O)e(O);else{var t={grant_type:"client_credentials",client_id:_,client_secret:P,scope:"read"};N.a.post("/oauth/token/",t).then(function(t){O=t.data.access_token,e(O)})}});case 2:return t=e.sent,a={headers:{Authorization:"Bearer ".concat(t)}},e.abrupt("return",new Promise(function(e){e(a)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var A={retrieveWishlist:function(){var e=Object(j.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return e([1])}));case 3:return t=e.sent,e.abrupt("return",new Promise(function(e){N.a.get("/api/v1/wishlist/",t).then(function(t){e(t.data)})}));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),wishlistAdd:function(){var e=Object(j.a)(x.a.mark(function e(t){var a,n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return a=e.sent,n={id:t},e.abrupt("return",N.a.post("/api/v1/wishlist/",n,a));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wishlistDelete:function(){var e=Object(j.a)(x.a.mark(function e(t){var a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return a=e.sent,e.abrupt("return",N.a.delete("/api/v1/wishlist/".concat(t,"/"),a));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wishlistCartStatus:function(){var e=Object(j.a)(x.a.mark(function e(t,a){var n,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return n=e.sent,r={id:t,added_to_cart:a},e.abrupt("return",N.a.patch("/api/v1/wishlist/".concat(t,"/"),r,n));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),retrieveList:function(){var e=Object(j.a)(x.a.mark(function e(t,a){var n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return(n=e.sent).params=a,n.params.page=t,e.abrupt("return",new Promise(function(e){N.a.get("/api/v1/public/packages/",n).then(function(t){e(t.data)})}));case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),retrieveDetails:function(){var e=Object(j.a)(x.a.mark(function e(t){var a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return a=e.sent,e.abrupt("return",new Promise(function(e){N.a.get("/api/v1/public/packages/".concat(t,"/"),a).then(function(t){e(t.data)})}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),createBooking:function(){var e=Object(j.a)(x.a.mark(function e(t){var a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return a=e.sent,e.abrupt("return",new Promise(function(e,n){N.a.post("/api/v1/bookings/",t,a).then(function(t){e(t.data)}).catch(function(e){n(e.response.data)})}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},T=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.context,t=e.wishlist,a=e.toggleWishlist;return r.a.createElement("section",{className:"List","data-testid":"list"},r.a.createElement("section",{className:"List-items"},r.a.createElement(g,{route:"/details/1",item:{id:1,name:"Example",thumbnail_url:"/images/map_channel.gif",price:777.77,rating:"easy",promo:"Tour package description"},wishlist:t,toggleWishlist:a})))}}]),t}(r.a.Component);T.context=v,(function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={list:[],pageIndex:1,totalItems:0,filters:{price_min:null,price_max:null,search:null}},a.updateList(),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"updateList",value:function(){var e=this,t=this.state,a=t.pageIndex,n=t.filters,r={};n.price_min&&(r.price_min=n.price_min),n.price_max&&(r.price_max=n.price_max),n.search&&n.search.length>0&&(r.search=n.search),A.retrieveList(a,r).then(function(t){var a=t.results,n=t.count;e.setState({list:a,totalItems:n})})}},{key:"updateFilters",value:function(e){var t=this;this.setState({filters:e},function(){t.updateList()})}},{key:"previousPage",value:function(){this.setState({pageIndex:this.state.pageIndex-1}),this.updateList()}},{key:"nextPage",value:function(){this.setState({pageIndex:this.state.pageIndex+1}),this.updateList()}},{key:"render",value:function(){var e=this.context,t=e.wishlist,a=e.toggleWishlist,n=this.state,i=n.list,c=n.pageIndex,s=n.totalItems;return r.a.createElement("section",{className:"List","data-testid":"list"},r.a.createElement("header",null,r.a.createElement(y,{onFilterUpdate:this.updateFilters.bind(this)})),r.a.createElement("section",{className:"List-items"},i.map(function(e){return r.a.createElement(g,{key:e.id,route:"/details/".concat(e.id),item:e,wishlist:t,toggleWishlist:a})})),r.a.createElement("footer",null,r.a.createElement(k,{pageIndex:c,total:s,perPage:9,onNext:this.nextPage.bind(this),onPrevious:this.previousPage.bind(this)})))}}]),t}(r.a.Component)).contextType=v;a(74);var F=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={details:null,alreadyAddedToCart:!1};var n=e.match.params.id;return A.retrieveDetails(n).then(function(e){var t=a.context.item;a.setState({details:e,alreadyAddedToCart:t&&t.id===n})}),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"addToCart",value:function(){var e=Object(j.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.setOrderItem(this.state.details);case 2:this.props.history.push("/checkout");case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.details,a=e.alreadyAddedToCart;return null===t?r.a.createElement("section",{className:"Details"}):r.a.createElement("section",{className:"Details","data-testid":"details"},r.a.createElement("section",{className:"Details-content"},r.a.createElement("header",null,r.a.createElement("h2",null,r.a.createElement(E,{itemId:t.id}),t.name)),r.a.createElement("section",null,r.a.createElement("img",{src:t.thumbnail_url,alt:t.name}),r.a.createElement("p",null,"Starts on: ",t.start),r.a.createElement("p",null,"Tour Length: ",t.tour_length," days"),r.a.createElement("p",null,r.a.createElement("span",{className:"Details-label"},"Total Price:"),"\xa0$",t.price)),r.a.createElement("section",null,t.promo)),r.a.createElement("section",{className:"Details-reserve"},r.a.createElement("button",{className:"Details-buy","data-testid":"buy",onClick:this.addToCart.bind(this)},a?"Already Reserved":"Reserve")))}}]),t}(r.a.Component);F.contextType=v;a(75);var W=a(19),D=(a(76),function(e){var t=Object(n.useState)(e.duration),a=Object(W.a)(t,2),i=a[0],c=a[1];return Object(n.useEffect)(function(){var e=setTimeout(function(){c(i-1)},1e3);return function(){clearTimeout(e)}}),i<=1?null:r.a.createElement("div",{className:"OnHold"},"Your tickets are on hold for the next ",i," seconds.")}),L=(r.a.Component,a(77),a(38));var U,B=(U=function(e){var t=e.name,a=e.label,n=e.value,i=e.onUpdate;return r.a.createElement("div",{key:t,className:"FormField"},r.a.createElement("label",null,a),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:t,value:n,onChange:function(e){i(t,e.target.value)}}))},function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={error:null},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"validate",value:function(e,t){0===t.length?this.setState({error:"Field cannot be empty"}):this.setState({error:null}),this.props.onUpdate(e,t)}},{key:"render",value:function(){var e=this.state.error,t=this.props,a=(t.onUpdate,Object(L.a)(t,["onUpdate"]));return r.a.createElement("div",{className:"Validated"},r.a.createElement(U,Object.assign({onUpdate:this.validate.bind(this)},a)),e&&r.a.createElement("div",{className:"Error"},e))}}]),t}(r.a.Component)),Y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={validationErrors:[],orderPlaced:!1},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"placeOrder",value:function(){var e=this;this.context.placeOrder().then(function(){e.setState({validationErrors:[],orderPlaced:!0})}).catch(function(t){e.setState({validationErrors:t,orderPlaced:!1})})}},{key:"render",value:function(){var e=this.context,t=e.booking,a=e.item,n=e.updateField,i=e.clearOrderItem,c=this.state,s=c.validationErrors,l=c.orderPlaced,o=[{label:"Name",name:"name"},{label:"Email Address",name:"email_address"},{label:"Street Address",name:"street_address"},{label:"City",name:"city"}],u=[];o.forEach(function(e){var t=s[e.name];t&&u.push(r.a.createElement("li",{className:"error",key:e.name},e.label,": ",t))});var m,p=o.map(function(e){return r.a.createElement(B,Object.assign({key:e.name,value:t[e.name],onUpdate:n},e))});return l?r.a.createElement("section",{className:"Checkout"},r.a.createElement("header",{className:"Checkout-header"},r.a.createElement("h2",null,"Checkout"),r.a.createElement("h3",null,"Thanks for buying an excursion with Explore California!"))):(a&&(m=r.a.createElement("div",null,r.a.createElement("button",{className:"Checkout-package-remove",onClick:function(){return i(a.id)}},r.a.createElement(b.b,null)),a.name," - $",a.price," starts on ",a.start," for ",a.tour_length," days.")),r.a.createElement("section",{className:"Checkout"},r.a.createElement("header",{className:"Checkout-header"},r.a.createElement("h2",null,"Checkout")),r.a.createElement("section",{className:"Checkout-summary"},a&&r.a.createElement(D,{duration:59}),m),r.a.createElement("section",{className:"Checkout-form"},r.a.createElement("form",null,r.a.createElement("ul",null,u),p)),r.a.createElement("section",{className:"Checkout-actions"},r.a.createElement("div",{className:"Checkout-actions__next"},r.a.createElement("button",{disabled:l||null===a,onClick:this.placeOrder.bind(this)},"Place order")))))}}]),t}(r.a.Component);function Z(e){var t=e.item;return r.a.createElement(h.b,{className:"Cart",to:"/checkout"},r.a.createElement(b.e,null),t&&t.name)}function z(e){return r.a.createElement("section",{className:"App-sidebar"},r.a.createElement("header",{className:"App-sidebar__header"},r.a.createElement("h2",null,"Our Tours")),r.a.createElement("section",{className:"App-sidebar__intro"},r.a.createElement("h3",null,"Explore California"),r.a.createElement("p",null,"What type of California experience do you want to have? Are you looking for an exciting adventure? A chance to relax and get away from it all? Or maybe you're looking for a chance to do something entirely new and enriching! As you can see, we've got you covered. We offer tours that are as diverse as California itself! Select any of our tours learn more about pricing and available options.")))}function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}Y.contextType=v;var Q=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={wishlist:[],booking:{name:"",email_address:"",street_address:"",city:""},item:null,toggleWishlist:a.toggleWishlist.bind(Object(p.a)(a)),updateField:a.updateField.bind(Object(p.a)(a)),setOrderItem:a.setOrderItem.bind(Object(p.a)(a)),clearOrderItem:a.clearOrderItem.bind(Object(p.a)(a)),placeOrder:a.placeOrder.bind(Object(p.a)(a))},A.retrieveWishlist().then(function(e){a.setState({wishlist:e})}),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"toggleWishlist",value:function(e){var t=this;(this.state.wishlist.includes(e)?A.wishlistDelete(e):A.wishlistAdd(e)).then(function(){A.retrieveWishlist().then(function(e){t.setState({wishlist:e})})})}},{key:"updateField",value:function(e,t){var a=this.state.booking;a[e]=t,this.setState({booking:a})}},{key:"setOrderItem",value:function(e){var t=this;return new Promise(function(a){t.setState({item:e}),a(e)})}},{key:"clearOrderItem",value:function(e){var t=this;return new Promise(function(e){t.setState({item:null}),e()})}},{key:"placeOrder",value:function(){var e=this,t=this.state,a=t.booking,n=t.item,r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(a,!0).forEach(function(t){Object(s.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a);return r.package=n.id,new Promise(function(t){A.createBooking(r).then(function(){e.setState({item:null}),t()})})}},{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("nav",{className:"App-nav"},r.a.createElement("div",{className:"App-nav__main"},r.a.createElement(h.c,{to:"/"},"Explore our tours")),r.a.createElement("div",{className:"App-nav__links"},r.a.createElement("button",null,"Advertise your tour"),r.a.createElement("button",null,"Help"),r.a.createElement(Z,{booking:this.state.booking}))),r.a.createElement(z,null),r.a.createElement("section",{className:"App-content"},r.a.createElement(v.Provider,{value:this.state},r.a.createElement(f.a,{path:"/",exact:!0,component:T}),r.a.createElement(f.a,{path:"/details/:id",component:F}),r.a.createElement(f.a,{path:"/checkout",component:Y})))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[39,1,2]]]);
//# sourceMappingURL=main.0b46f3b1.chunk.js.map